<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mediaelement@4.2.7/build/mediaelementplayer.min.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous" />
    <script src="https://kit.fontawesome.com/98661e544f.js" crossorigin="anonymous"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <!-- <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-heart"
        viewBox="0 0 16 16">
        <path
            d="m8 2.748-.717-.737C5.6.281 2.514.878 1.4 3.053c-.523 1.023-.641 2.5.314 4.385.92 1.815 2.834 3.989 6.286 6.357 3.452-2.368 5.365-4.542 6.286-6.357.955-1.886.838-3.362.314-4.385C13.486.878 10.4.28 8.717 2.01L8 2.748zM8 15C-7.333 4.868 3.279-3.04 7.824 1.143c.06.055.119.112.176.171a3.12 3.12 0 0 1 .176-.17C12.72-3.042 23.333 4.867 8 15z" />
    </svg> -->
    <link rel="stylesheet" href="../../style.css" />
    <title>PodScholar</title>
</head>

<body>
    <%- include('nav.html') %>
    <div class="container mt-5 mb-5">

        <div class="row d-flex justify-content-center">

            <div class="col-md-7">

                <div class="card p-5 py-4 " id="account">
                    <div class="d-flex justify-content-between">
                        <div class="" id="header">
                            <img src="https://i.imgur.com/bDLhJiP.jpg" width="100" class="rounded-circle pr-3">
                            <h5 class="d-inline ml-4 profile"> Profile </h5>
                        </div>
                        <button type="button" class="btn btn-dark h-50 mt-4" id="follow">Follow</button>
                    </div>


                    <div class="mt-3">
                        <!-- <span class="bg-secondary p-1 px-4 rounded text-white">Pro</span> -->

                        <div class="card-body">
                            <!-- <h5 class="mt-2 mb-0"><%= user.fname %> <%= user.lname %></h5>
                            <span>Gold Author</span> -->
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Full Name</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.fname%> <%= user.lname%></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Scientific Discipline</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.discipline %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Tags</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.tag %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Current Affiliation</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.affiliation %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Email at Academic Organization</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.orgemail %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-5">
                                    <p class="mb-0">Proof of Academic Affiliation</p>
                                </div>
                                <div class="col-sm-7">
                                    <p class="text-muted mb-0"><%= user.affproof %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Google Scholar</p>
                                    <p class="text-muted mb-0"><%= user.googlescholar %></p>
                                </div>
                                <div class="col-sm-6">
                                    <p class="mb-0">Researchgate</p>
                                    <p class="text-muted mb-0"><%= user.researchgate %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Linkedin</p>
                                    <p class="text-muted mb-0"><%= user.linkedin %></p>
                                </div>
                                <div class="col-sm-6">
                                    <p class="mb-0">ORCID</p>
                                    <p class="text-muted mb-0"><%= user.orcid %></p>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Followers</p>
                                    <% if (user.followers) { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark"
                                            href="#"><%= user.followers.length %></a>
                                    </p>
                                    <% } else { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark" href="#">0</a>
                                    </p>
                                    <% } %>
                                </div>
                                <div class="col-sm-6">
                                    <p class="mb-0">Authored Podcasts</p>
                                    <% if (user.uploadedPodcast) { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark"
                                            href="/users/:id/podcasts/authored"><%= user.uploadedPodcast.length %></a>
                                    </p>
                                    <% } else { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark" href="#">0</a>
                                    </p>
                                    <% } %>
                                </div>
                            </div>
                            <hr>
                            <div class="row">
                                <div class="col-sm-6">
                                    <p class="mb-0">Saved Podcasts</p>
                                    <% if (user.savedPodcast) { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark"
                                            href="/users/:id/podcasts/saved"><%= user.savedPodcast.length %></a>
                                    </p>
                                    <% } else { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark" href="#">0</a>
                                    </p>
                                    <% } %>
                                </div>
                                <div class="col-sm-6">
                                    <p class="mb-0">Liked Podcasts</p>
                                    <% if (user.likedPodcast) { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark"
                                            href="/users/:id/podcasts/liked"><%= user.likedPodcast.length %></a>
                                    </p>
                                    <% } else { %>
                                    <p class="text-muted mb-0 d-inline"><a class="btn btn-outline-dark" href="#">0</a>
                                    </p>
                                    <% } %>
                                </div>
                            </div>
                        </div>
                        <br>
                        <ul class="social-list">
                            <li><i class="fa fa-facebook"></i></li>
                            <li><i class="fa fa-dribbble"></i></li>
                            <li><i class="fa fa-instagram"></i></li>
                            <li><i class="fa fa-linkedin"></i></li>
                            <li><i class="fa fa-google"></i></li>
                        </ul>
                    </div>


                </div>

            </div>

        </div>

    </div>

    </div>
    <div>
        <%- include('footer.html') %>
    </div>
</body>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    var session = window.sessionStorage.getItem("userId");
    if (session != null) {
        axios({
            method: 'get',
            url: '/api/users/<%= user._id %>/actions/follow',
            validateStatus: () => true
        })
            .then(function (response) {
                console.log(response.data)
                if (response.data == "Same user") {
                    $("#follow").remove();
                    // $(".profile").html("Profile")
                } else if (response.data == "Yes") {
                    $("#follow").html("Following");
                }
            })
            .catch(function (error) {
                console.log(error);
            });
    }
    $("#follow").click(function () {
        if (session == null) {
            alert("Please log in to follow this user");
        } else if ($("#follow").text() == "Follow") {
            axios({
                method: 'post',
                url: '/api/users/<%= user._id %>/actions/follow',
                validateStatus: () => true
            })
                .then(function (response) {
                    if (response.data == "Error") {
                        alert("Error! Please try later");
                    } else {
                        $("#follow").html("Following");
                    }
                })
                .catch(function (error) {
                    console.log(error);
                });
        } else if ($("#follow").text() == "Following") {
            axios({
                method: 'post',
                url: '/api/users/<%= user._id %>/actions/unfollow',
                validateStatus: () => true
            })
                .then(function (response) {
                    if (response.data == "Error") {
                        alert("Error! Please try later");
                    } else {
                        $("#follow").html("Follow");
                    }
                })
                .catch(function (error) {
                    console.log(error);
                });
        }
    });
</script>
<script type="text/javascript" src="../../scripts/session.js"></script>

</html>